{"version":3,"sources":["../sdk/scripts/buildfire/components/control/tagsInput/tagsInput.js"],"names":["buildfire","components","control","Tagify","document","write","tagsInput","constructor","selector","data","this","_readyToFireEvent","_tagifyTags","activeTags","container","_source","settings","source","_sourceType","i","length","_validateSource","Error","sourceType","allowAutoComplete","allowUserInput","maxTags","languageSettings","placeholder","_init","item","value","_container","querySelector","_buildComponent","_tagify","input","tagifyOptions","whitelist","autoComplete","enabled","rightKey","enforceWhitelist","userInput","on","_onAddRemoveTag","innerHTML","_addButton","addEventListener","set","items","_input","map","tag","onUpdate","tags","append","_tags","Array","isArray","push","addTags","clear","removeAllTags","get","event","userTagsInput","super","options","callback","auth","showTagsSearchDialog","err","result","console","error","_currentTags","allTags","tagName","j","splice"],"mappings":"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","file":"tagsInput.min.js","sourcesContent":["if (typeof buildfire == 'undefined')\n\tthrow 'please add buildfire.js first to use buildfire components';\nif (typeof buildfire.components == 'undefined') buildfire.components = {};\nif (typeof buildfire.components.control == 'undefined') buildfire.components.control = {};\n\nif (typeof Tagify == 'undefined') {\n\tdocument.write('<script src=\"' + '../../../../scripts/tagify/tagify.min.js\"></script>');\n\tdocument.write('<script src=\"' + '../../../../scripts/tagify/tagify.polyfills.min.js\"></script>');\n}\n\nbuildfire.components.control.tagsInput = class TagsInput {\n\n\tconstructor(selector, data = {}) {\n\t\t// tags arrays\n\t\tthis._readyToFireEvent = true;\n\t\tthis._tagifyTags = null;\n\t\tthis.activeTags = [];\n\t\tthis.container = null;\n\t\tthis.selector = selector || null;\n\n\t\tlet _source = data.settings?.source ? data.settings.source : [];\n\t\tlet _sourceType = 'list';\n\t\tif (typeof _source === \"function\") {\n\t\t\t_sourceType = 'custom';\n\t\t} else {\n\t\t\t//validate the list\n\t\t\tfor (let i = 0; i < _source.length; i++) {\n\t\t\t\tif (!this._validateSource(_source[i])) {\n\t\t\t\t\tthrow Error('Invalid source, missing value');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.settings = {\n\t\t\tsource: _source,\n\t\t\tsourceType: _sourceType,\n\t\t\tallowAutoComplete: typeof (data.settings?.allowAutoComplete) === 'undefined' ? true : data.settings.allowAutoComplete,\n\t\t\tallowUserInput: typeof (data.settings?.allowUserInput) === 'undefined' ? true : data.settings.allowUserInput,\n\t\t\tmaxTags: data.settings?.maxTags || null\n\t\t}\n\t\t// languageSettings = strings\n\t\tthis.languageSettings = {\n\t\t\tplaceholder: data.languageSettings?.placeholder || \"Select Tags\",\n\t\t}\n\t\tthis._init();\n\t}\n\n\t_validateSource(item) {\n\t\tif (item && item.value && typeof (item.value) === \"string\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t_init() {\n\t\tlet _container = document.querySelector(this.selector);\n\t\tif (!_container) throw new Error('Element not found!');\n\t\telse {\n\t\t\tthis.container = _container;\n\t\t\tthis._buildComponent();\n\t\t}\n\t}\n\n\t_tagify(input) {\n\t\tlet  tagifyOptions = {\n\t\t\twhitelist: this.settings.sourceType === 'list' ? this.settings.source : [],\n\t\t\tautoComplete: {\n\t\t\t\tenabled: this.settings.allowAutoComplete,\n\t\t\t\trightKey: this.settings.allowAutoComplete\n\t\t\t},\n\t\t\tenforceWhitelist: false,\n\t\t\tuserInput: this.settings.allowUserInput\n\t\t}\n\n\t\tif(this.settings.maxTags) tagifyOptions = {...tagifyOptions, maxTags: this.settings.maxTags}\n\n\t\tthis._tagifyTags = new Tagify(input, tagifyOptions);\n\n\t\tthis._tagifyTags.on('remove', () => this._onAddRemoveTag());\n\t\tthis._tagifyTags.on('change', () => this._onAddRemoveTag());\n\t}\n\n\t_buildComponent() {\n\t\tif (this.settings.sourceType === 'list')\n\t\t\tthis.container.innerHTML = `<input type=\"text\" class=\"form-control\" placeholder=\"${this.languageSettings.placeholder}\" >`\n\t\telse {\n\t\t\tthis.container.innerHTML = `\n            <div class=\"input-group\">\n                <input type=\"text\" class=\"form-control tagify_input_hide_courser\" placeholder=\"${this.languageSettings.placeholder}\" >\n                <span class=\"input-group-addon icon icon-plus add_tagBtn\"></span>\n            </div>`\n\n\t\t\tlet _addButton = this.container.querySelector('span');\n\t\t\t_addButton.addEventListener('click', () => {\n\t\t\t\tthis.settings.source({}, (items) => {\n\t\t\t\t\tthis.set(items);\n\t\t\t\t});\n\t\t\t})\n\t\t}\n\n\t\tlet _input = this.container.querySelector('input');\n\n\t\tthis._tagify(_input);\n\t}\n\n\t_onAddRemoveTag() {\n\t\tthis.activeTags = (this._tagifyTags.value.length) ? this._tagifyTags.value.map(tag => {\n\t\t\treturn tag;\n\t\t}) : [];\n\n\t\tif (this._readyToFireEvent) {\n\t\t\tthis.onUpdate({tags: this.activeTags});\n\t\t}\n\t}\n\n\t// methods\n\tappend(data) {\n\t\tlet _tags = [];\n\t\tif (data && Array.isArray(data)) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tif (this._validateSource(data[i])) {\n\t\t\t\t\t_tags.push(data[i]);\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error('Invalid data, missing value');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._validateSource(data)) {\n\t\t\t\t_tags.push(data);\n\t\t\t} else {\n\t\t\t\tthrow Error('Invalid data, missing value');\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tfor (let i = 0; i < _tags.length; i++) {\n\t\t\tif (!this.settings.maxTags || this.activeTags.length < this.settings.maxTags) {\n\t\t\t\tthis.activeTags.push(_tags[i]);\n\t\t\t}\n\t\t}\n\t\tthis._tagifyTags.addTags(_tags);\n\t}\n\n\tclear() {\n\t\tthis.activeTags = [];\n\t\tthis._tagifyTags.removeAllTags();\n\t}\n\n\tset(data) {\n\t\tthis._readyToFireEvent = false;\n\t\tthis.activeTags = [];\n\t\tthis._tagifyTags.removeAllTags();\n\t\tthis._readyToFireEvent = true;\n\t\tthis.append(data);\n\t}\n\n\tget() {\n\t\treturn this.activeTags;\n\t}\n\n\t// events && handlers\n\tonUpdate(event) {\n\t\tthrow new Error('function not implemented');\n\t}\n}\n\nbuildfire.components.control.userTagsInput = class UserTagsInput extends buildfire.components.control.tagsInput {\n\n\tconstructor(selector, data = {}) {\n\n\t\tlet _data = {\n\t\t\tsettings: {\n\t\t\t\tsource: (options, callback) => {\n\t\t\t\t\tbuildfire.auth.showTagsSearchDialog({ maxTags: data.settings?.maxTags }, (err, result) => {\n\t\t\t\t\t\tif (err) return console.error(err);\n\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\tlet _currentTags = this.get();\n\t\t\t\t\t\t\tlet allTags = [...result, ..._currentTags];\n\t\t\t\t\t\t\t// since tagify require value property, we are appending it and we are removing it from exposed method when returning the value \"get, onUpdate\"\n\t\t\t\t\t\t\tallTags = allTags.map(tag => ({...tag, value: tag.tagName}));\n\n\t\t\t\t\t\t\t// remove repeat tags\n\t\t\t\t\t\t\tfor (let i = 0; i < allTags.length; i++) {\n\t\t\t\t\t\t\t\tfor (let j = i + 1; j < allTags.length; j++) {\n\t\t\t\t\t\t\t\t\tif (allTags[i].value === allTags[j].value) {\n\t\t\t\t\t\t\t\t\t\tallTags.splice(j, 1);\n\t\t\t\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tcallback(allTags);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tallowAutoComplete: false,\n\t\t\t\tallowUserInput: false,\n\t\t\t\tmaxTags: data.settings?.maxTags || null\n\t\t\t},\n\t\t\tlanguageSettings: data.languageSettings,\n\t\t}\n\t\tsuper(selector, _data);\n\t}\n}\n"]}